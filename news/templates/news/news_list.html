{% extends 'base.html' %}
{% load i18n %}

{% block content %}
<section class="max-w-screen-xl mx-auto px-4 py-10">
  <h1 class="text-3xl font-bold mb-6 text-center text-gray-800">{% trans "Архів новин" %}</h1>

  {% for year, news_items in news_by_year %}
    <h2 class="text-2xl font-semibold mt-10 mb-4 text-gray-700">{{ year }}</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      {% for news in news_items %}
        <div x-data="{ open: false, zoomed: false }" class="bg-white rounded-lg shadow border border-gray-200 overflow-hidden transition-all duration-300">
          <div class="cursor-pointer" @click="open = !open">
            {% if news.image %}
              <img 
                src="{{ news.image.url }}" 
                alt="{{ news.title }}" 
                class="w-full h-48 object-cover transition duration-300 transform hover:scale-105 cursor-zoom-in"
                @click.stop="zoomed = true"
              >
            {% endif %}
            <div class="p-4">
              <h2 class="text-xl font-semibold text-gray-800">{{ news.title }}</h2>
              <p class="text-sm text-gray-500">{{ news.created_at|date:"d.m.Y H:i" }}</p>
            </div>
          </div>
          <div x-show="open"
               x-cloak
               x-transition:enter="transition-all duration-500 ease-in-out"
               x-transition:leave="transition-all duration-500 ease-in-out"
               x-collapse
               class="px-4 pb-4 text-gray-700 text-sm max-h-[600px] overflow-y-auto">
            {{ news.content|linebreaks }}
            <a href="{% url 'news_detail' news.pk %}" class="text-blue-600 hover:underline block mt-2">{% trans "Детальніше →" %}</a>
            <button @click="open = false" class="text-sm text-gray-500 mt-2 hover:underline">{% trans "← Згорнути" %}</button>
          </div>
          <div 
            x-show="zoomed" 
            x-transition 
            x-cloak
            class="fixed inset-0 z-50 bg-black bg-opacity-80 flex items-center justify-center"
            @click.self="zoomed = false"
            @keydown.window.escape="zoomed = false"
          >
            <div class="relative max-w-5xl w-full max-h-[90vh] overflow-auto p-4">
              <button 
                class="absolute top-2 right-2 text-white text-3xl font-bold focus:outline-none"
                @click="zoomed = false"
                aria-label="{% trans 'Закрити' %}"
              >&times;</button>
              <img 
                src="{{ news.image.url }}" 
                alt="{{ news.title }}" 
                class="w-full h-auto rounded shadow-lg"
              >
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  {% endfor %}
</section>
{% endblock %}